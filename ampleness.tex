\input{preamble}
\input{tools}
\begin{document}
\title{Projectivity of $\overline{M}_g$}
\maketitle

\section{Nakai--Moishezon for schemes}
In this section, we prove an ampleness criterion for invertible sheaves on
schemes over a field using intersection theory.
The next result can be seen as a converse to~\citeSP{0BEV}.

\begin{lemma}[Nakai--Moishezon Criterion]
\label{schemes-lemma-nakai-moishezon}
Let $X$ be a proper scheme over an algebraically closed field $k$.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Then $\mathcal{L}$ is ample on $X$ if and only if
for every integral closed subscheme $Y$ of $X$,
$(\mathcal{L}^{\dim(Y)} \cdot Y) > 0$.
\end{lemma}

\begin{proof}
If $\mathcal{L}$ is ample on $X$, then the positivity of the intersection
number on integral closed subschemes follows from~\citeSP{0BEV}.

Conversely, assume that for every integral closed subscheme $Y$ of $X$,
$(\mathcal{L}^{\dim(Y)} \cdot Y) > 0$.
We show that $\mathcal{L}$ is ample.
Using~\citeSP{0B5V} and~\citeSP{09MS}, we reduce to the case $X$ is integral.
We proceed by induction on $\dim(X)$.
When $\dim(X) = 1$, our assumption says that $\deg(\mathcal{L}) > 0$ and hence
$\mathcal{L}$ is ample by~\citeSP{0B5X}.

Now suppose $\dim(X) > 1$ and that the theorem is true for all proper schemes
of lower dimension.
Since $X$ is integral, $\mathcal{L}$ has a regular meromorphic section
by~\citeSP{02OZ}.
Let $\mathcal{I}_1$ be the sheaf of denominators of $\mathcal{L}$ and set
$\mathcal{I}_2 = \mathcal{I}_1 \otimes \mathcal{L}$.
Let $Y_j$ be the closed subschemes defined by $\mathcal{I}_j$ with $j = 1,2$.
By~\citeSP{02P0}, $\dim(Y_j) < \dim(X)$.
Then, for all $m \geq 0$, we the following commutative diagram with exact rows:
$$
\xymatrix{
  0 \ar[r]
    & \mathcal{I}_1 \otimes \mathcal{L}^{\otimes m} \ar[r] \ar@{=}[d]
    & \mathcal{L}^{\otimes m} \ar[r]
    & \mathcal{L}^{\otimes m}\rvert_{Y_1} \ar[r]
    & 0 \\
  0 \ar[r]
    & \mathcal{I}_2 \otimes \mathcal{L}^{\otimes (m-1)} \ar[r]
    & \mathcal{L}^{\otimes (m-1)} \ar[r]
    & \mathcal{L}^{\otimes (m-1)}\rvert_{Y_2} \ar[r]
    & 0.
}
$$
By induction, $\mathcal{L}\rvert_{Y_j}$ is ample on $Y_j$ for $j = 1,2$.
Hence by~\citeSP{0B5U}, there is some $m_0 \geq 0$
such that for all $m \geq m_0$,
$H^i(Y_j,\mathcal{L}^{\otimes m}\rvert_{Y_j}) = 0$ for all $i > 0$.
Thus, taking the long exact sequence in cohomology of the sequences above,
for $i \geq 2$,
$$
  h^i(X,\mathcal{L}^{\otimes m})
    = h^i(X,\mathcal{I}_1 \otimes \mathcal{L}^{\otimes m})
    = h^i(X,\mathcal{I}_2 \otimes \mathcal{L}^{\otimes (m - 1)})
    = h^i(X,\mathcal{L}^{\otimes (m-1)})
$$
for all $m > m_0$.
Hence, for all $m > m_0$,
$$
N := \sum\nolimits_{i = 2}^{\dim(X)} (-1)^i\,h^i(X,\mathcal{L}^{\otimes m})
$$
is a constant.
Now since $\chi(X,\mathcal{L}^{\otimes m})$ has leading coefficient
$(\mathcal{L}^{\dim X} \cdot X)$, which is positive by assumption,
we see that
$$
  \chi(X,\mathcal{L}^{\otimes m})
    = h^0(X,\mathcal{L}^{\otimes m}) - h^1(X,\mathcal{L}^{\otimes m})
      + N \to \infty
$$
as $m \to \infty$. Thus,
$h^0(X,\mathcal{L}^{\otimes m}) - h^1(X,\mathcal{L}^{\otimes m}) \to \infty$
as $m \to \infty$; in particular,
$h^0(X,\mathcal{L}^{\otimes m}) \to \infty$ as $m \to \infty$.
By Lemma~\citeSP{01PS}, we may replace $\mathcal{L}$ by
$\mathcal{L}^{\otimes m}$ to assume $\mathcal{L} = \mathcal{O}_X(D)$ for some
effective Cartier divisor $D$.

We now claim that $\mathcal{L}^{\otimes m} = \mathcal{O}_X(mD)$ is generated by
its global sections for $m \gg 0$. Consider the short exact sequence
$$
0 \longrightarrow \mathcal{O}_X((m-1)D) \longrightarrow \mathcal{O}_X(mD)
\longrightarrow \mathcal{O}_D(mD) \longrightarrow 0.
$$
Since $\mathcal{O}_D(mD)$ is ample by the inductive hypothesis,
Serre vanishing~\citeSP{0B5U} implies
$H^1(D,\mathcal{O}_D(mD)) = 0$ for $m \gg 0$, hence the maps
$$
\rho_m : H^1(X,\mathcal{O}_X((m -1)D)) \longrightarrow H^1(X,\mathcal{O}_X(mD))
$$
arising from the long exact sequence on cohomology
are surjective for all $m \gg 0$. Since the vector spaces
$H^1(X,\mathcal{O}_X(mD))$ are all finite-dimensional, we have that for $m \gg
0$, the sequence
$$h^1(X,\mathcal{O}_X(mD)) \ge h^1(X,\mathcal{O}_X((m+1)D)) \ge \cdots$$
is a nonincreasing sequence of nonnegative integers, and thus stabilizes for $m
\gg 0$. The maps $\rho_m$ are therefore bijective for $m \gg 0$, hence
\begin{equation}\label{eq:restriction-surjects}
  H^0(X,\mathcal{O}_X(mD)) \longrightarrow H^0(D,\mathcal{O}_D(mD))
\end{equation}
is surjective for $m \gg 0$. We can now show $\mathcal{O}_X(mD)$ is generated by
global sections. If $x \in X \setminus D$, then a global section in
$H^0(X,\mathcal{O}_X(mD))$ defining $mD$ generates $(\mathcal{O}_X(mD))_x$,
since $\mathcal{O}_X(mD)$ restricted to $X \setminus D$ is trivial.
Otherwise, suppose $x \in D$. By inductive hypothesis, since $\mathcal{O}_D(D)$
is ample, the invertible sheaf $\mathcal{O}_D(mD)$ is generated by global
sections for all $m \gg 0$, i.e., the morphism
$$
H^0(D,\mathcal{O}_D(mD)) \otimes_k \mathcal{O}_D \longrightarrow
\mathcal{O}_D(mD)
$$
is surjective. Thus, in the commutative diagram
$$
\xymatrix{
  H^0(X,\mathcal{O}_X(mD)) \otimes_k \mathcal{O}_X/\mathfrak{m}_x
  \ar[r]\ar@{->>}[d] & \mathcal{O}_X(mD) \otimes_{\mathcal{O}_X}
  \mathcal{O}_X/\mathfrak{m}_x \ar[d]^\simeq\\
  H^0(D,\mathcal{O}_D(mD)) \otimes_k \mathcal{O}_D/\mathfrak{m}_x \ar@{->>}[r] &
  \mathcal{O}_D(mD) \otimes_{\mathcal{O}_D} \mathcal{O}_D/\mathfrak{m}_x
}
$$
the bottom arrow is surjective. By \eqref{eq:restriction-surjects}, the left
arrow is surjective. The commutativity of the diagram implies the top row is
surjective, hence
$$
H^0(X,\mathcal{O}_X(mD)) \otimes_k \mathcal{O}_{X,x} \longrightarrow
(\mathcal{O}_X(mD))_x
$$
is surjective by Nakayama's lemma, i.e., $\mathcal{O}_X(mD)$ is generated by
global sections.

We therefore see that $\mathcal{O}_X(mD)$ induces a morphism $f : X \to
\mathbf{P}^n_k$ such that $f^*\mathcal{O}_{\mathbf{P}^n}(1) =
\mathcal{O}_X(mD)$ for $m \gg 0$. As $X$ is proper, $f$ is proper.
We now claim that for all $y \in \mathbf{P}^n_k$, the fiber $X_y$ has finitely
many points. If not, we have a commutative diagram
$$
\xymatrix{
  X \ar[r]^f & \mathbf{P}^n_k\\
  X_y \ar@{^{(}->}[u] \ar[r] & \Spec(k(y)) \ar@{^{(}->}[u]\\
  C \ar@{^{(}->}[u]\ar[ur]_\pi
}
$$
where the top square is cartesian, and $C$ is a complete curve in $X_y$. By
commutativity of the diagram, we see that
$$
  \mathcal{L}\rvert_C =
    (f^*\mathcal{O}_{\mathbf{P}^n}(1))\rvert_C \simeq
    \pi^*\mathcal{O}_{\Spec(k(y))} =
    \mathcal{O}_C,
$$
which is a contradiction, since $(\mathcal{L}^{\dim X - 1} \cdot C) > 0$ by (2),
whereas $\mathcal{O}_C$ has constant Euler characteristic. Thus, $f$ is
quasi-finite; since it is proper by the fact that both $X$ and $\mathbf{P}^n_k$
are proper, we moreover have that $f$ is finite by~\citeSP{02OG}.
Since the pullback of an ample invertible sheaf via a quasi-finite morphism is
ample by~\citeSP{0892} and finite
morphisms are quasi-finite by definition,
$\mathcal{O}_X(mD)$ is ample for $m \gg 0$.
Hence $\mathcal{O}_X(D)$ is ample by~\citeSP{01PS}.
\end{proof}

\section{Numerical intersection theory for spaces}
For the proof of the Nakai--Moishezon critera for algebraic spaces, we will
need to enhance~\citeSP{0DN0} and~\citeSP{0DN3} with generalizations of results
from~\citeSP{0BEI} and~\citeSP{0BEL}.

To begin, we require a generalization of~\citeSP{0BEK}.

\begin{lemma}
\label{lemma-euler-characteristic-morphism}
Let $k$ be a field.
Let $f : Y \to X$ be a morphism of proper algebraic spaces over $k$.
Let $\mathcal{G}$ be a coherent $\mathcal{O}_Y$-module.
Then
$$
\chi(Y, \mathcal{G}) = \sum (-1)^i \chi(X, R^if_*\mathcal{G})
$$
\end{lemma}

\begin{proof}
The formula makes sense: the sheaves $R^if_*\mathcal{G}$ are coherent
and only a finite number of them are nonzero, see~\citeSP{08AR}
and~\citeSP{073G}.
By the Leray spectral sequence~\citeSP{0732} there is a spectral sequence with
$$
E_2^{p, q} = H^p(X, R^qf_*\mathcal{G})
$$
converging to $H^{p + q}(Y, \mathcal{G})$.
By finiteness of cohomology on $X$ we see that only a finite number of
$E_2^{p, q}$ are nonzero and each $E_2^{p, q}$ is a finite dimensional vector
space.
It follows that the same is true for $E_r^{p, q}$ for $r \geq 2$ and that
$$
\sum (-1)^{p + q} \dim_k E_r^{p, q}
$$
is independent of $r$.
Since for $r$ large enough we have $E_r^{p, q} = E_\infty^{p, q}$ and since
convergence means there is a filtration on $H^n(Y, \mathcal{G})$ whose graded
pieces are $E_\infty^{p, q}$ with $p + 1 = n$ (this is the meaning of
convergence of the spectral sequence), we conclude.
\end{proof}

This is a generalization of~\citeSP{0BET} to algebraic spaces.

\begin{lemma}
\label{lemma-intersection-number-and-pullback}
Let $k$ be a field.
Let $f : Y \to X$ be a morphism of proper algebraic spaces over $k$.
Let $Z \subset Y$ be an integral closed subspace of dimension $d$ and let
$\mathcal{L}_1, \ldots, \mathcal{L}_d$ be invertible $\mathcal{O}_X$-modules.
Then
$$
(f^*\mathcal{L}_1 \cdots f^*\mathcal{L}_d \cdot Z) =
\deg(f|_Z : Z \to f(Z)) (\mathcal{L}_1 \cdots \mathcal{L}_d \cdot f(Z))
$$
where $\deg(Z \to f(Z))$ is as in
{\it \cite[\href{http://stacks.math.columbia.edu/tag/0AD6}{Tag 0AD6}]{stacks-project}}
or $0$ if $\dim(f(Z)) < d$.\todo{Prove this.}
\end{lemma}
%\begin{proof}
%The left hand side is computed using the coefficient of $n_1 \ldots n_d$
%in the function
%$$
%\chi(Y, \mathcal{O}_Z \otimes f^*\mathcal{L}_1^{\otimes n_1} \otimes
%\ldots \otimes f^*\mathcal{L}_d^{\otimes n_d}) =
%\sum (-1)^i
%\chi(X, R^if_*\mathcal{O}_Z \otimes
%\mathcal{L}_1^{\otimes n_1} \otimes \ldots \otimes
%\mathcal{L}_d^{\otimes n_d})
%$$
%The equality follows from Lemma \ref{lemma-euler-characteristic-morphism}
%and the projection formula
%\cite[\href{http://stacks.math.columbia.edu/tag/0944}{Tag 0944}]{stacks-project}.
%If $f(Z)$ has dimension $< d$, then the right hand side
%is a polynomial of total degree $<d$ by
%Lemma \ref{lemma-numerical-polynomial-from-euler}
%and the result is true. Assume $\dim(f(Z)) = d$. Let
%$\xi \in \lvert f(Z) \rvert$ be the generic point. By
%dimension theory
%the generic point of $Z$ is the unique point of $Z$ mapping to $\xi$.
%Then $f : Z \to f(Z)$ is finite over a nonempty open of $f(Z)$, see
%Morphisms, Lemma \ref{morphisms-lemma-generically-finite}.
%Thus $\deg(f : Z \to f(Z))$ is defined and in fact it is equal
%to the length of the stalk of $f_*\mathcal{O}_Z$ at $\xi$
%over $\mathcal{O}_{X, \xi}$. Moreover, the stalk of
%$R^if_*\mathcal{O}_X$ at $\xi$ is zero for $i > 0$ because
%we just saw that $f|_Z$ is finite in a neighbourhood of $\xi$
%(so that Cohomology of Schemes, Lemma
%\ref{coherent-lemma-finite-pushforward-coherent} gives the vanishing).
%Thus the terms $\chi(X, R^if_*\mathcal{O}_Z \otimes
%\mathcal{L}_1^{\otimes n_1} \otimes \ldots \otimes
%\mathcal{L}_d^{\otimes n_d})$ with $i > 0$ have total
%degree $< d$ and
%$$
%\chi(X, f_*\mathcal{O}_Z \otimes
%\mathcal{L}_1^{\otimes n_1} \otimes \ldots \otimes
%\mathcal{L}_d^{\otimes n_d})
%=
%\deg(f : Z \to f(Z)) \chi(f(Z),
%\mathcal{L}_1^{\otimes n_1} \otimes \ldots \otimes
%\mathcal{L}_d^{\otimes n_d}|_{f(Z)})
%$$
%modulo a polynomial of total degree $< d$ by
%Lemma \ref{lemma-numerical-polynomial-leading-term}.
%The desired result follows.
%\end{proof}

\section{Nakai--Moishezon Criterion}

\begin{lemma}
\label{lemma-surjective-finite-morphism-ample}
Let $R$ be a Noetherian ring.
Let $X$ and $Y$ be algebraic spaces over $R$.
Let $f : Y \to X$ be a proper morphism of algebraic spaces over $R$.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Assume $f$ is finite and surjective.
Then $\mathcal{L}$ is ample if and only if $f^*\mathcal{L}$ is ample.
\end{lemma}

\begin{proof}
Suppose that $\mathcal{L}$ is ample.
Then $X \to \Spec(R)$ is representable and hence $X$ is a scheme.
But $f : Y \to X$ is finite and hence affine, so,
by~\citeSP{03WG}, $f$ is representable.
Therefore $Y$ is a scheme.
Then $f^*\mathcal{L}$ is ample by the schemes case,~\citeSP{0B5V}.

\medskip\noindent
Assume that $f^*\mathcal{L}$ is ample.
Let $P$ be the following property on coherent $\mathcal{O}_X$-modules
$\mathcal{F}$:
there exists an $n_0$ such that $H^p(X, \mathcal{F} \otimes
\mathcal{L}^{\otimes n}) = 0$ for all $n \geq n_0$ and $p > 0$.
We will prove that $P$ holds for any coherent $\mathcal{O}_X$-module
$\mathcal{F}$, which suffices to prove that $\mathcal{L}$ is ample.
We are going to apply~\citeSP{07UT}.
Thus we have to verify (1), (2) and (3) of that lemma for $P$.
Property (1) follows from the long exact cohomology sequence associated
to a short exact sequence of sheaves and the fact that tensoring with
an invertible sheaf is an exact functor.
Property (2) follows since $H^p(X, -)$ is an additive functor.
To see (3) let $Z \subset X$ be reduced closed subspace with $|Z|$
irreducible.
Form the fibre product diagram
$$
\xymatrix{
  W \ar[r]_{i'} \ar[d]_{f'} & Y \ar[d]^{f} \\
  Z \ar[r]^{i} & X.
}
$$
Let $\mathcal{G} = f'_*\mathcal{O}_W$.
Since $f'$ is surjective, part (3)(a) of~\citeSP{07UT} holds.
For part (3)(b), let $\mathcal{I} \subset \mathcal{O}_Z$ be a nonzero sheaf
of ideals.
Let $\mathcal{G}' = \mathcal{I}\mathcal{G}$.
We have
$$
\mathcal{I} \mathcal{G} = f'_*(\mathcal{I}')
$$
where $\mathcal{I}' = \Im((f')^*\mathcal{I} \to \mathcal{O}_W)$.
This is true because $f'$ is a (representable) affine morphism of
algebraic spaces and hence the result can be checked on an \'etale
covering of $Z$ by a scheme in which case the result is~\citeSP{01YP}.
Finally, $f'$ is affine, hence $R^pf'_*\mathcal{I}' = 0$ for all $p > 0$
by~\citeSP{073H}.
Hence
\begin{align*}
H^p(X, \mathcal{G}' \otimes_{\mathcal{O}_X} \mathcal{L}^{\otimes n})
  & = H^p(X, i_*f_*'\mathcal{I}' \otimes_{\mathcal{O}_X} \mathcal{L}^{\otimes n}) \\
  & = H^p(X, f_*(i'_*\mathcal{I}' \otimes_{\mathcal{O}_Y} f^*\mathcal{L}^{\otimes n})) \\
  & = H^p(Y, i'_*\mathcal{I}' \otimes_{\mathcal{O}_Y} f^*\mathcal{L}^{\otimes n}) = 0
\end{align*}
since $f^*\mathcal{L}$ is ample.
This verifies (3)(c) of~\citeSP{07UT} as desired.
\end{proof}

\begin{lemma}[Nakai--Moishezon Criterion for algebraic spaces]
\label{spaces-lemma-nakai-moishezon}
Let $k$ be a field.
Let $X$ be a proper algebraic space over $k$.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Then $\mathcal{L}$ is ample on $X$ with respect to $k$ if and only if
for every integral closed subspace $Y$ of $X$,
$(\mathcal{L}^{\dim(Y)} \cdot Y) > 0$.
\end{lemma}
\begin{proof}
  Assume that $\mathcal{L}$ is ample on $X$ with respect to $k$. 
  Then $X$ is a scheme, and $\mathcal{L}$ is ample on $X/k$ in the
  scheme-theoretic sense by~\citeSP{0D32}.
  Now~\citeSP{0BEV} implies the positivity of interesction numbers.

  Suppose that for every integral closed subspace $Y$ of $X$,
  $(\mathcal{L}^{\dim(Y)} \cdot Y) > 0$.
  We show that $\mathcal{L}$ is ample on $X$ with respect to $k$.
  By~\citeSP{09YC}, there is a finite surjective map $p : X' \to X$ from a
  scheme $X'$.
  By Lemma~\ref{lemma-surjective-finite-morphism-ample}, $\mathcal{L}$ is
  ample if and only if $p^*\mathcal{L}$ is ample. 
  Thus, by the Nakai--Moishezon criterion for schemes
  (Lemma~\ref{schemes-lemma-nakai-moishezon}),
  it suffices to show that for every integral closed subscheme $Y'$ in $X'$, we
  have $(p^*\mathcal{L}^{\dim(Y')} \cdot Y') > 0$.
  Let $Y$ be the image of $Y'$ in $Y$;
  by Lemma~\ref{lemma-intersection-number-and-pullback}, we then have
  $$
  ( (p^*\mathcal{L})^{\dim Y'} \cdot Y') = \deg(p\rvert_{Y'} : Y' \to
  Y)(\mathcal{L}^{\dim Y'} \cdot Y).
  $$
  Note $\dim Y' = \dim Y$ since $p\rvert_{Y'} : Y' \to Y$ is finite surjective.
  Since $(\mathcal{L}^{\dim Y} \cdot Y) > 0$ by (2), we therefore see that
  $( (p^*\mathcal{L})^{\dim Y'} \cdot Y') > 0$.
\end{proof}

\section{Ampleness Lemma}
In this section, we formulate and prove the Ampleness Lemma 
of~\cite[Lemmas 3.9 and 3.13]{ko90}.

\begin{lemma}
\label{lemma-grassman-quotient-stack-map}
Let $X$ be a scheme over a field $k$, and let $\mathcal{E}$ be a%semipositive
locally free sheaf on $X$ of rank $n$.
Let $\mathcal{F} = \mathrm{Sym}^d(\mathcal{E})$ for some $d \geq 1$ and
let $N = \binom{n + d}{d}$ be the rank.
Let $on \mathcal{F} \to \mathcal{Q}$ be a locally free quotient of rank $q$.
Let $G = \mathrm{PGL}_m$ be the projective general linear group over $k$.
Then,
\begin{enumerate}
\item There exists a closed subscheme $D \subset
\mathbf{P}((\mathcal{E}^\vee)^{\oplus n})$ such that
$$
\mathbf{P}((\mathcal{E}^\vee)^{\oplus n}) \setminus D \longrightarrow X
$$
is a principal $G$-bundle.
\item There is a $G$-action on $\mathrm{Gr}(N,q)$, and
a $G$-equivariant map
$$
\mathbf{P}((\mathcal{E}^\vee)^{\oplus n}) \setminus D \longrightarrow
\mathrm{Gr}(N,q).
$$
\item There exists a map of stacks
$$
X \longrightarrow [\mathrm{Gr}(N,q)/G].
$$
\end{enumerate}
\end{lemma}
\begin{proof}
We first prove (1).
Let $\mathbf{P} = \mathbf{P}((\mathcal{E}^\vee)^{\oplus n})$ be the projective
bundle of matrices whose columns belong to $\mathcal{E}$, and write
$\pi : \mathbf{P} \to X$ for the projection.
Using the projection formula~\citeSP{01E6},
\begin{align*}
H^0(\mathbf{P}, \pi^*\mathcal{E}(1))
& \cong H^0(X, \pi_*(\pi^*\mathcal{E} \otimes_{\mathcal{O}_{\mathbf{P}}}
\mathcal{O}_{\mathbf{P}}(1)))\\
& \cong H^0(X,\mathcal{E} \otimes_{\mathcal{O}_X}
\pi_*\mathcal{O}_{\mathbf{P}}(1))\\
& \cong H^0(X,\mathcal{E} \otimes (\mathcal{E}^\vee)^{\oplus n})\\
& \cong H^0(X,\mathrm{End}(\mathcal{E})^{\oplus n})
\end{align*}
has $n$ sections, corresponding to the identity on each summand.
We therefore have an evaluation morphism
$$
B : \mathcal{O}_{\mathbf{P}}^{\oplus n} \longrightarrow \pi^*\mathcal{E}(1).
$$
Taking determinants, this gives a map
$$
\det B : \mathcal{O}_{\mathbf{P}} \longrightarrow \det(\pi^*\mathcal{E})(n).
$$
Let $\mathcal{I} \otimes \det(\pi^*\mathcal{E}) (n)$ be the image of $\det B$,
and let $D$ be the subscheme of $\mathbf{P}$ defined by $\mathcal{I}$.
Then, $D$ defines the locus for which $\det B$ vanishes, which is the locus of
$\mathbf{P}$ where the corresponding matrices are not invertible.
We therefore see that $\mathbf{P} \setminus D$ corresponds to those matrices
that are invertible, i.e., are elements of $\mathrm{PGL}_n$.
This turns $\mathbf{P} \setminus D$ into a principal $\mathrm{PGL}_n$-bundle
over $X$.

For (2), note that $\mathrm{PGL}_n$ acts on $\mathrm{Gr}(N,q)$ via
$$
  \mathrm{GL}_n \longrightarrow
  (\mathrm{GL}_n)^{\times d} \longrightarrow
  \mathrm{Aut}(\mathrm{Sym}^d (k^{\oplus n})),
$$
which descends to their quotients by $k^*$; note that
$\mathrm{Aut}(\mathrm{Sym}^d (k^{\oplus n}))/k^*$ is a subgroup of the
automorphism group of the Grassmannian $\mathrm{Gr}(N,q)$.
To show the morphism claimed exists, we fist consider what happens when we
apply $\mathrm{Sym}^d$ to $B$, giving a morphism
$$
  \mathrm{Sym}^d(B) : \mathcal{O}_{\mathbf{P}}^{\oplus N} \to
    \pi^*\mathrm{Sym}^d(\mathcal{E})(d) = \pi^*\mathcal{F}(d).
$$
Composing this will the given surjection $\mathcal{F} \to \mathcal{Q}$, we
obtain a morphism
$$
  U : \mathcal{O}_{\mathbf{P}}^{\oplus N} \to
        \pi^*\mathcal{F}(d) \to
        \pi^*\mathcal{Q}(d)
$$
which is surjective away from $D$.
By the universal property of the Grassmannian, we obtain a morphism
$\mathbf{P} \setminus D \to \mathrm{Gr}(N,q)$.
It is $G$-equivariant by tracing the definitions.

For (3), this follows from general properties of quotient stacks, plus the fact
that $(\mathbf{P} \setminus D)/G \simeq X$.
\end{proof}

\begin{lemma}
\label{lemma-positive-self-intersection}
Let $X$ be a normal projective variety over a field $k$.
Let $\mathcal{E}$ be a semipositive locally free sheaf on $X$ of rank $n$.
Set $\mathcal{F} = \mathrm{Sym}^d(\mathcal{E})$ for some $d \geq 1$ and set
$N = \binom{n + d}{d}$ be the rank.
Let $\mathcal{Q}$ be a locally free quotient of $\mathcal{F}$ of rank $q$.
Assume that the map
$$
  u : X \to [\mathrm{Gr}(N,q)/G]
$$
constructed in Lemma \ref{lemma-grassman-quotient-stack-map}
is generically quasi-finite.
Then $(\det(\mathcal{Q})^{\dim(Y)}) > 0$.
\end{lemma}

\begin{proof}
Let $\mathbf{P} = \mathbf{P}((\mathcal{E}^\vee)^{\oplus n})$.
Let $D \subset \mathbf{P}$ be the closed subscheme given by part (1) of
Lemma \ref{lemma-grassman-quotient-stack-map}.
Then there is a fibre product diagram\todo{Why, exactly, is this a fibre product
diagram? Also, the $u$ is off.}
$$
\xymatrix{
  \mathbf{P} \setminus D \ar[r] \ar[d] & \mathrm{Gr}(N,q) \ar[d] \\
  X \ar[r]^u & [\mathrm{Gr}(N,q)/\mathrm{PGL}_m]
}
$$
Since $u$ is generically quasi-finite, the map
$\mathbf{P} \setminus D \to \mathrm{Gr}(n,q)$ is generically quasi-finite.

As in Lemma \ref{lemma-grassman-quotient-stack-map},\todo{Maybe factor
  this statement out?}
the morphism $\mathbf{P} \setminus D \to \mathrm{Gr}(N,q)$ is defined by
the morphism of locally free sheaves
$$
  U : \mathcal{O}_{\mathbf{P}}^{\oplus n} \to \pi^*\mathcal{F}(d)
                                          \to \pi^*\mathcal{Q}(d).
$$
Here, the map $\mathcal{O}_{\mathbf{P}}^{\oplus N} \to \pi^*\mathcal{F}$ is
an isomorphism away from $D$ and thus $U$ is surjective away from $D$.
Taking $q$\textsuperscript{th} exterior powers, we obtain a morphism
$$
  \bigwedge^q U : \mathcal{O}_{\mathbf{P}}^{\oplus \binom{N}{q}} \to
    \pi^*\det(\mathcal{Q})(qd)
$$
which is surjective away from $D$.
Thus the image of $\bigwedge^q U$ is of the form
$\pi^*\det(\mathcal{Q})(qd) \otimes \mathcal{I}$ for some ideal sheaf
$\mathcal{I} \subset \mathcal{O}_{\mathbf{P}}$.

Let $g : \mathbf{P}' \to \mathbf{P}$ be the blow up of $\mathbf{P}$ along the
sheaf $\mathcal{I}$.
Then the rational map from $\mathbf{P}$ to $\mathrm{Gr}(N,q)$ defined above
resolves to a morphism
$$
  u' : \mathbf{P}' \to \mathrm{Gr}(N,q)
$$
such that
$$
  g^*\pi^*\det(\mathcal{Q})(qd) \cong
    u'^*\mathcal{O}_{\mathrm{Gr}(N,q)}(1)
      \otimes_{\mathcal{O}_{\mathbf{P}'}}
    \mathcal{O}_{\mathbf{P}'}(E)
$$
where $E$ is the exceptional divisor of $g : \mathbf{P}' \to \mathbf{P}$.

Since $u$ is generically quasi-finite and $g$ is birational,
$u'$ is generically quasi-finite.
Hence, by ...\todo{Prove this or reference this somewhere.}
$u'^*\mathcal{O}_{\mathrm{Gr}(N,q)}(1)$ is big\todo{Define big somewhere}
on $\mathbf{P}'$.
Fix an ample invertible sheaf $\mathcal{L}$ on $Y$.
Then by ...\todo{Using properties of big. I guess this depends on what the definition
  is and then what the characterizations are.}, there is some $m \geq 0$
such that
$\mathcal{O}_{\mathrm{Gr}(N,q)}(m)
  \otimes_{\mathcal{O}_{\mathbf{P}'}} g^*\pi^*\mathcal{L}^{-1}$
has a nonzero section.
But
\begin{align*}
  \mathcal{O}_{\mathrm{Gr}(N,q)}(m)
  = \big(g^*\pi^*\det(\mathcal{Q})(qd) \otimes_{\mathcal{O}_{\mathbf{P}'}}
    \mathcal{O}_{\mathbf{P}'}(-E)\big)^{\otimes m}.
\end{align*}
Thus we obtain a nonzero morphism of sheaves
$$
\mathcal{O}_{\mathbf{P}'} \to
    \big(g^*\pi^*\det(\mathcal{Q})(qd) \otimes_{\mathcal{O}_{\mathbf{P}'}}
      \otimes_{\mathcal{O}_{\mathbf{P}'}}
    \mathcal{O}_{\mathbf{P}'}(-E)\big)^{\otimes m}
      \otimes_{\mathcal{O}_{\mathbf{P}'}}
    g^*\pi^*\mathcal{L}^{-1}
$$
for all $m \geq 0$ large.
Since $E$ is effective, we can compose this morphism with the natural
inclusion $\mathcal{O}_{\mathbf{P}'}(-E) \to \mathcal{O}_{\mathbf{P}'}$
to obtain a nonzero morphism
$$
\mathcal{O}_{\mathbf{P}'} \to
    g^*\big(\pi^*\det(\mathcal{Q})^{\otimes m}(mqd)
      \otimes_{\mathcal{O}_{\mathbf{P}}}
    \pi^*\mathcal{L}^{-1}\big).
$$
Pushing this forward to $X$ and applying the projection formula, we obtain
a nonzero morphism
$$
\mathcal{O}_X \to
  \det(\mathcal{Q})^{\otimes m}
    \otimes_{\mathcal{O}_X}
  \pi_*\mathcal{O}_{\mathbf{P}}(mqd)
    \otimes_{\mathcal{O}_X}
  \mathcal{L}^{-1}.
$$
Since each term on the right is locally free, this is equivalent to a nonzero
morphism
$$
\tau :
  (p_*\mathcal{O}_{\mathbf{P}}(mqd))^\vee \otimes_{\mathcal{O}_X} \mathcal{L}
    \to \det(\mathcal{Q})^{\otimes m}.
$$
As before, there exists an ideal sheaf $\mathcal{J} \subseteq \mathcal{O}_X$
such that the image of $\tau$ is the subsheaf
$\mathcal{J} \otimes_{\mathcal{O}_X} \det(\mathcal{Q})^{\otimes m}$ of
$\det(\mathcal{Q})^{\otimes m}$.
Let $s : X' \to X$ be the blow up of $X$ along $\mathcal{J}$.
Set
$P = \mathbf{P}((\pi_*\mathcal{O}_{\mathbf{P}}(mqd))^\vee
        \otimes_{\mathcal{O}_X} \mathcal{L})$.
Then $\tau$ gives rise to a morphism
$v : X' \to P$
such that
$$
v^*\mathcal{O}_P(1) = s^*\det(\mathcal{Q})^{\otimes m}
                        \otimes_{\mathcal{O}_{X'}} \mathcal{O}_{X'}(-F)
$$
for the exceptional divisor $F$ of the blow up $s : X' \to X$.
Set $P' = \mathbf{P}((\pi_*\mathcal{O}_{\mathbf{P}}(mqd))^\vee)$.
Then there exists a canonical isomorphism\todo{Find a reference for this.}
$P \to P'$.
Let $v' : X' \to P'$ be the composition of $v$ with this isomorphism.
Then
$
\mathcal{L} \otimes_{\mathcal{O}_{X'}} v'^* \mathcal{O}_{P'}(1)
  = v^* \mathcal{O}_P
$, so
$$
  s^*\det(\mathcal{Q})^{\otimes m}
    = s^*\mathcal{L}
        \otimes_{\mathcal{O}_{X'}} v'^* \mathcal{O}_{P'}(1)
        \otimes_{\mathcal{O}_{X'}} \mathcal{O}_{X'}(F).
$$

We now compute the top self-intersection of $\det(\mathcal{Q})^{\otimes m}$.
Since $s : X' \to X$ is birational, by~\citeSP{0BET},
$$
  ((\det(\mathcal{Q})^{\otimes m})^{\dim(X)})
    = ((s^*\det(\mathcal{Q})^{\otimes m})^{\dim(X')}).
$$
Write
$\mathcal{L}'
  = v'^*\mathcal{O}_{P'}(1) \otimes_{\mathcal{O}_{X'}} \mathcal{O}_{X'}(F)$.
By~\citeSP{0BER} we further have
$$
  ((\det(\mathcal{Q})^{\otimes m})^{\dim(X)})
    = (s^*\mathcal{L}^{\dim(X)})
      + \sum\nolimits_{i = 1}^{\dim(X)}
          (s^*\mathcal{L}^{\dim(X) - i} (s^*\det(\mathcal{Q})^{\otimes m})^{i - 1} \mathcal{L}').
$$
Since $(\pi_*\mathcal{O}_{\mathbf{P}}(mqd))^\vee$ is semipositive by
...\todo{Reference back to the semipostivity stuff!},
$\mathcal{O}_{P'}(1)$ is nef and hence its $v'$ pullback to $X'$ is nef.
As $F$ is effective, $\mathcal{L}'$ is nef.
Since $\mathcal{L}$ is ample, $s^*\mathcal{L}$ is nef, so
$s^*\det(\mathcal{Q})^{\otimes m}$ is nef.
All this shows that the second term in the sum above is nonnegative.
Applying~\citeSP{0BET} again,
$$
  (s^*\mathcal{L}^{\dim(X)}) = (\mathcal{L}^{\dim(X)}) > 0
$$
since $\mathcal{L}$ is ample on $X$.
Thus $((\det(\mathcal{Q})^{\otimes m})^{\dim(X)}) > 0$, so by additivity of
numerical intersections again, $(\det(\mathcal{Q})^{\dim(X)}) > 0$.
\end{proof}

\begin{lemma}
Let $k$ be a field.
Let $X$ be a proper algebraic space over $k$.
Let $\mathcal{E}$ be a locally free sheaf of rank $n$ on $X$.
Set $\mathcal{F} = \mathrm{Sym}^d(\mathcal{E})$ for some $d \geq 1$ and
let $N = \binom{n + d}{d}$ be the rank.
Let $\mathcal{Q}$ be a locally free quotient of $\mathcal{F}$ of rank $q$.
Assume that the map
$$
u : X \to [\mathrm{Gr}(N,q)/\mathrm{PGL}_n]
$$
constructed in Lemma \ref{lemma-grassman-quotient-stack-map}
is generically quasi-finite.
Then $\det(\mathcal{Q})$ is ample.
\end{lemma}

\begin{proof}
By the Nakai--Moishezon Criterion for spaces,
Lemma~\ref{spaces-lemma-nakai-moishezon},
we must show that $\det(Q)$ has positive top intersection with every
irreducible subspace $Z \subset X$.
So let $Z \subset X$ be any irreducible subspace and write $i : Z \to X$ for
the inclusion.
By~\citeSP{088U} there is a projective scheme $Z'$ and a proper birational
morphism $g : Z' \to Z$.
Now
$$
  (\det(Q)^{\dim(Z)} \cdot Z)
    = (\det(i^*Q)^{\dim(Z)})
    = (\det(g^*i^*Q)^{\dim(Z')})
$$
so we need to show that the top self-intersection of $\det(g^*i^*\mathcal{Q})$
on $Z'$ is positive.
But now $g^*i^*\mathcal{E}$ is semipositive by ...\todo{Reference.},
$g^*i^*\mathcal{F} \cong \mathrm{Sym}^d(g^*i^*\mathcal{E})$,
and $g^*i^*\mathcal{Q}$ is a quotient bundle of $g^*i^*\mathcal{F}$ of rank $q$
on $Z'$.
Also, the map $u \circ i \circ g : Z' \to [\mathrm{Gr}(N,q)/\mathrm{PGL}_n]$
is quasi-finite on the dense open on which $g$ is an isomorphism.
Thus Lemma~\ref{lemma-positive-self-intersection},
$(\det(g^*i^*\mathcal{Q})^{\dim(Z')}) > 0$ and we are done.
\end{proof}
\bibliographystyle{plain}
\bibliography{references}

\end{document}
