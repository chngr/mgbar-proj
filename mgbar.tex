\input{preamble}

\newcommand{\todo}[1]{\footnote{\textbf{TODO.} #1}}
\begin{document}
\title{Projectivity of moduli of curves}
\maketitle

\section{Stable curves}
\begin{lemma}[{\cite[\href{http://stacks.math.columbia.edu/tag/0E76}{Tag 0E76}]{stacks-project}.}]
\label{lemma-stable-curves}
There exist an open substack $\Curvesstack^{stable} \subset \Curvesstack$
such that
\begin{enumerate}
\item given a family of curves $f : X \to S$ the following are equivalent
\begin{enumerate}
\item the classifying morphism $S \to \Curvesstack$ factors
through $\Curvesstack^{stable}$,
\item $X \to S$ is a stable family of curves,
\end{enumerate}
\item given $X$ a scheme proper over a field $k$ with
$\dim(X) \leq 1$ the following are equivalent
\begin{enumerate}
\item the classifying morphism $\Spec(k) \to \Curvesstack$
factors through $\Curvesstack^{stable}$,
\item the singularities of $X$ are at-worst-nodal, $\dim(X) = 1$,
$k = H^0(X, \mathcal{O}_X)$, the genus of $X$ is $\geq 2$, and
$X$ has no rational tails or bridges,
\item the singularities of $X$ are at-worst-nodal, $\dim(X) = 1$,
$k = H^0(X, \mathcal{O}_X)$, and $\omega_{X_s}$ is ample.
\end{enumerate}
\end{enumerate}
\end{lemma}

\section{Semipositivity Results}
In this section, we prove a semipositivity result,
Lemma \ref{lemma-stable-curves-semipositive}, for the pushforward of the
relative dualizing sheaf of families of curves.

\begin{lemma}
Let $k$ be a field.
Let $f : S \to C$ be a flat family of curve...\todo{Formulate the hypotheses of
this better; this is Kollar's Proposition 4.5.}
If $k \geq 2$, then $f_*\omega_{S/C}^{\otimes k}$ is semipositive for $k \geq 2$.
\end{lemma}

\begin{lemma}
\label{lemma-stable-curves-semipositive-resolve}
Let $k$ be a field.
Let $C$ be a proper smooth $k$-scheme of dimension $1$.
Let $\pi : S \to C$ be a flat morphism whose fibres are stable nodal and arithmetic
genus $g \geq 2$.
Let $f : S' \to S$ is a resolution of the isolated singularities of $S$
and let $\pi' : S' \to C$ be the composition $\pi' = \pi \circ f$.
If $\pi'_*(\omega_{S'/C}^{\otimes m})$ is semipositive for $m \geq 2$, then
$\pi_*(\omega_{S/C}^{\otimes m})$ is semipositive.
\end{lemma}

\begin{lemma}[cf.\ {\cite[Theorem 4.3]{Ko90}}]
\label{lemma-stable-curves-semipositive}
Let $k$ be a field.
Let $C$ be a proper connected smooth $k$-scheme of dimension $1$.
Let $\pi : S \to C$ be a family of stable curves,
as defined in Lemma \ref{lemma-stable-curves}.
Then $f_*(\omega_{S/C}^{\otimes m})$ is semipositive for $m \geq 2$.
\end{lemma}

\begin{definition}[cf.\ {\cite[Definition 4.1(i)]{Ko90}}]
\label{definition-semismooth}
Let $k$ be a field.
Let $X$ be an algebraic variety over $k$.
We say $X$ is {\it semismooth} if all of its closed points are analytically
isomorphic to one of the following:
\begin{enumerate}
\item a smooth point;
\item a double crossing point $\{x_1x_2 = 0\} \subset \mathbf{A}^n$; or
\item a pinch point $\{x_1^2 - x_2^2x_3 = 0\} \subset \mathbf{A}^n$.
\end{enumerate}
In this case the singular locus is smooth, and we call it the {\it double
divisor} of $X$.
\end{definition}

\begin{situation}
\label{situation-kollar-theorem-4.3}
Let $k$ be a field.
Let $S$ be a complete Gorenstein integral $k$-scheme of dimension $2$ that is
semismooth.
Let $C$ be a complete connected regular $k$-scheme of dimension $1$.
Let $f : S \to C$ be a surjective map onto $C$, such that the general fiber of
$f$ has only nodes as singularities.
\end{situation}

\begin{lemma}
\label{lemma-base-change-okay}
Consider Situation \ref{situation-kollar-theorem-4.3}.
Let $C'$ be a complete connected smooth $k$-scheme of dimension $1$, and
consider the cartesian square
$$
\xymatrix{
S' \ar[d]_{f'}\ar[r]^{g'} & S\ar[d]^f\\
C' \ar[r]^g & C
}
$$
where $g: C' \to C$ is surjective.
If for some $m$, the sheaf $f'_*(\omega_{S'/C'}^{\otimes m})$ is semipositive,
then $f_*(\omega_{S/C}^{\otimes m})$ is semipositive.
\end{lemma}
\begin{proof}
Suppose $f_*(\omega_{S/C}^{\otimes m})$ is not semipositive, i.e., there
exists a quotient
$$f_*(\omega_{S/C}^{\otimes m}) \longrightarrow L$$
where $L$ is an invertible sheaf of negative degree.
Pulling back to $C'$, we then obtain a quotient
$$g^*f_*(\omega_{S/C}^{\otimes m}) \longrightarrow g^*L$$
of $g^*f_*(\omega_{S/C}^{\otimes m})$ that has negative degree on $C'$.
Since $f$ is flat \cite[\href{http://stacks.math.columbia.edu/tag/00R4}{Tag
00R4}]{stacks-project}, we can apply flat base change
\cite[\href{http://stacks.math.columbia.edu/tag/02KH}{Tag 02KH}]{stacks-project}
to obtain
\end{proof}

\begin{theorem}[cf.\ {\cite[Theorem 4.3]{Ko90}}]
\label{theorem-kollar-theorem-4.3}
In Situation \ref{situation-kollar-theorem-4.3}, 
the sheaf $f_*(\omega_{S/C}^{\otimes m})$ is semipositive for $m \ge 2$. 
\end{theorem}








\section{Semipositivity after twisting by sections}

\begin{situation}\label{kollar_prop_4.7}
Let $k$ be a field.
Let $C$ be a proper smooth $k$-scheme of dimension 1.
Let $S$ be a proper smooth $k$-scheme of dimension 2.
Let $\pi:S\to C$ be a family of stable nodal curves whose fibers have arithmetic genus $g$.
Let $C_1,\ldots,C_n$ be a set of pairwise distinct sections of $f$.
Let $m\ge2$ be an integer.
Let $a_1,\ldots,a_n$ be non-negative integers such that $a_i\le m$ for each $i$.
\end{situation}

\begin{lemma}\label{base_case_genus_0}
Suppose we are in Situation \ref{kollar_prop_4.7} where $g=0$ and the sections $C_i$ are pairwise disjoint.
Assume that $\sum a_i\le 2k-1$.
Then $f_{*}(\omega_{S/C}^{k}(\sum a_iC_i))=0$. 
\end{lemma}


\begin{lemma}\label{inductive_step_genus_0}
Suppose we are in Situation \ref{kollar_prop_4.7} where $g=0$ and the sections $C_i$ are pairwise disjoint.
Then $f_{*}(\omega_{S/C}^{k}(\sum a_iC_i))$ is semipositive.
\end{lemma}

\begin{lemma}\label{inductive_step_genus_1}
Suppose we are in Situation \ref{kollar_prop_4.7} where $g=1$ and the sections $C_i$ are pairwise disjoint.
Then $f_{*}(\omega_{S/C}^{k}(\sum a_iC_i))$ is semipositive.
\end{lemma}

\begin{lemma}\label{inductive_step_genus_2}
Suppose we are in Situation \ref{kollar_prop_4.7} where $g=2$ and the sections $C_i$ are pairwise disjoint.
Then $f_{*}(\omega_{S/C}^{k}(\sum a_iC_i))$ is semipositive.
\end{lemma}
\begin{proof}
We proceed by induction on $\sum a_i$. 
The base case where all of the $a_i$ are equal to zero is \todo{insert ref to kollar 4.5}.
Assume the claim is proven for $D_{j-1}=\sum a_iC_i$; we will prove it for $D_{j}=D_{j-1}+C_t$.
By \todo{insert ref to our version of kollar 4.6}, $\omega_{S/C}\cdot C_t\ge0$.

Consider the exact sequence
\begin{equation*}\label{exact_seq_of_section_twisted}
0\to\omega_{S/C}^{\otimes m}(D_{j-1})\to\omega_{S/C}^{\otimes m}(D_j)\to \omega_{S/C}^{\otimes m}(D_j)|_{C_t}\to0
\end{equation*}
obtained by tensoring the closed subscheme exact sequence for $C_t$ with $\omega_{S/C}^{\otimes m}$.

Then, $\omega_{S/C}^{\otimes m}(D_j)|_{C_t}\cong \omega_{S/C}^{\otimes (k-a_{t}-1)}|_{C_t}$, because the $C_i$ are pairwise disjoint.
Because $a_{t}+1\le k$ by assumption, this invertible sheaf has non-negative degree.

We now claim that $R^{1}f_{*}\omega_{S/C}^{\otimes m}(D_{j-1}))=0$.
Indeed, by Cohomology and Base Change and the fact that $f$ has relative dimension 2, it suffices to note that $H^{1}(S_x,\omega_{S_x/\kappa(x)}^{\otimes m}(D_{j-1}\cdot S_x))=0$ for each fiber $S_x$ of $f$, which is clear by Serre Duality and degree considerations.


Thus, applying $f_{*}$ to (\ref{exact_seq_of_section_twisted}) expresses $f_{*}(\omega_{S/C}^{k}(\sum a_iC_i))$ as an extension of the positive degree invertible sheaf $f_{*}\omega_{S/C}^{\otimes (k-a_{t}-1)}|_{C_t}$ by the semipositive locally free sheaf $f_{(}\omega_{S/C}^{\otimes m}(D_{j-1})$, which is semipositive by \todo{ref to semipositivity section}.
Here we have used the fact that $C_t$ is a section, hence $f_{*}\omega_{S/C}^{\otimes (k-a_{t}-1)}|_{C_t}$ is an invertible sheaf on $C$ of the same degree as that of $\omega_{S/C}^{\otimes (k-a_{t}-1)}|_{C_t}$ on $C_t$.



\end{proof}



\begin{lemma}
Suppose we are in Situation \ref{kollar_prop_4.7}.
Then $f_{(}(\omega_{S/C}^{k}(\sum a_iC_i))$ is semipositive.
\end{lemma}
\begin{proof}
Reduce to the case where the sections are disjoint by blowing up.
\end{proof}

\bibliographystyle{unsrt}
\bibliography{references}
\end{document}
